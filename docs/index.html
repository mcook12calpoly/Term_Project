<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Term Project Cook Louie: Term Project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Term Project Cook Louie<span id="projectnumber">&#160;0.1</span>
   </div>
   <div id="projectbrief">2.5 Axis Plotter</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Term Project </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Software_Design"></a>
Software Design</h1>
<h2><a class="anchor" id="Task_Diagram"></a>
Task Diagram</h2>
<p >The figure below shows the task diagram for our plotter. The user/main task allows the user to input a file to read G-Code from. The user/main task then sends a single line of G-Code to the "G-Code to Position" task, which converts the G-Code to encoder setpoint values. These setpoints are then passed to the encoder task, which sends PWM values for the motor based on the encoder value and setpoint. When the movement has been completed, the encoder task sends a flag to the user/main task to indicate that the next line of G-Code is ready to be processed. </p><div class="image">
<img src="Task_Diagram.png" alt=""/>
</div>
<h2><a class="anchor" id="User_Task"></a>
User/Main Task FSM</h2>
<p >The figure below shows the FSM diagram for the user/main task. This task waits for the user to input a file to read G-Code from. Once a file has been specified, it reads a single line. If share_d is true, this indicates that the previous movement has completed, and the current line is stored in share variable share_g for use in "G-Code to Position" task. </p><div class="image">
<img src="Main_FSM.png" alt=""/>
</div>
<h2><a class="anchor" id="G_Code"></a>
G-Code to Position Task FSM</h2>
<p >The figure below shows the FSM diagram for the G-Code to Position Task. This task takes the data from share_g (1 line of G-Code) and parses it. Depending on the first 3 characters of the line, different states are entered. If the command is a movement command, the X and Y coordinates are translated to polar setpoints, and desired setpoint values are passed to the encoder task. Otherwise, the command is performed and the task returns to state 0, waiting for data. </p><div class="image">
<img src="G_Code_FSM.png" alt=""/>
</div>
<h2><a class="anchor" id="Encoder"></a>
Encoder Task FSM</h2>
<p >This task takes the position setpoints from the G code task and determines which motors/servo need to move and what PWM value to set each to. The PWM values are shared to the motor driver via share_e. The encoder position is read and if the desired setpoint is reached, the task will inform the main task via share_d and the task will wait for the next input. If the setpoint has not been reached, the task will continue to determine PWM values to follow the inputted command. </p><div class="image">
<img src="Encoder_FSM.png" alt=""/>
</div>
 </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
